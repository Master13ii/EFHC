// src/libs/Env.ts import { createEnv } from '@t3-oss/env-nextjs'; import { z } from 'zod';

/**

Environment configuration using @t3-oss/env-nextjs.

NEXT_PUBLIC_CLERK_SIGN_IN_URL теперь имеет значение по умолчанию '/sign-in'. */ export const Env = createEnv({ server: { // Arcjet API ключ (опционально), должен начинаться с 'ajkey_' ARCJET_KEY: z.string().startsWith('ajkey_').optional(), // Секретный ключ Clerk (обязательно) CLERK_SECRET_KEY: z.string().min(1), // Остальные серверные переменные (опционально) DATABASE_URL: z.string().optional(), LOGTAIL_SOURCE_TOKEN: z.string().optional(), }, client: { // Базовый URL приложения (опционально) NEXT_PUBLIC_APP_URL: z.string().optional(), // Публичный ключ Clerk (обязательно) NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1), // URL для входа Clerk (по умолчанию '/sign-in') NEXT_PUBLIC_CLERK_SIGN_IN_URL: z.string().min(1).default('/sign-in'), // Остальные клиентские переменные (опционально) NEXT_PUBLIC_POSTHOG_KEY: z.string().optional(), NEXT_PUBLIC_POSTHOG_HOST: z.string().optional(), }, shared: { // Режим окружения (опционально) NODE_ENV: z.enum(['test', 'development', 'production']).optional(), }, runtimeEnv: { ARCJET_KEY: process.env.ARCJET_KEY, CLERK_SECRET_KEY: process.env.CLERK_SECRET_KEY, DATABASE_URL: process.env.DATABASE_URL, LOGTAIL_SOURCE_TOKEN: process.env.LOGTAIL_SOURCE_TOKEN, NEXT_PUBLIC_APP_URL: process.env.NEXT_PUBLIC_APP_URL, NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, // Если не задана, вернётся '/sign-in' NEXT_PUBLIC_CLERK_SIGN_IN_URL: process.env.NEXT_PUBLIC_CLERK_SIGN_IN_URL ?? '/sign-in', NODE_ENV: process.env.NODE_ENV, NEXT_PUBLIC_POSTHOG_KEY: process.env.NEXT_PUBLIC_POSTHOG_KEY, NEXT_PUBLIC_POSTHOG_HOST: process.env.NEXT_PUBLIC_POSTHOG_HOST, }, });




Я обновил весь файл src/libs/Env.ts целиком:

Поле NEXT_PUBLIC_CLERK_SIGN_IN_URL теперь с дефолтным значением '/sign-in' в схеме и в runtimeEnv.

Сохранены остальные проверки и преобразования.


Скопируйте и замените старый src/libs/Env.ts этим кодом. После этого переменная NEXT_PUBLIC_CLERK_SIGN_IN_URL всегда будет определена и сборка пройдет успешно. Не забудьте держать ваши другие переменные (NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, CLERK_SECRET_KEY, ARCJET_KEY) в .env.local и на Vercel. Если нужно сразу полный next.config.ts — дайте знать!

